# Требования к разрабатываемым гемам

Все разрабатываемые гемы должны соответствовать следующим требованиям:
- Гем должен иметь репозиторий на Github, в организации Abak Press.
  Это касается как создаваемых с нуля гемов, так и форков чужих гемов. 
- Гемы содержащие специфичную бизнес-логику, именуются с префиксом apress, для них основным неймспейсом является Apress.  
  Пример: гем apress-company_user_bindings, неймспейс Apress::CompanyUserBindings.
  
- Гемы интеграции сервисов именуются без префикса apress: service-integration.
- Гемы содержащие бизнес-логику (apress-гемы), должны быть приватными.
- Гемы не содержащие бизнес-логику, могут быть полезны сообществу и должны быть публичными, если это не убер - разработка, конечно.

- Гем должен версионироваться, согласно правилам Semantic Versioning.
- Код гема должен иметь документацию, оформленную, согласно спецификации TomDoc.
- README.md должен содержать название гема, информацию о назначении гема, правила разработки и выпуска релиза гема.  
  Приветствуется документация к гему, основные варианты его использования.   
  Более-менее годные примеры:  
  - https://github.com/abak-press/sphinx-integration
  - https://github.com/abak-press/kirby
  
- Должен быть настроен Continuous Integration, на базе Dolly.

- Должен быть настроен контроль качества кода и степень покрытия тестами, на базе Сode Сlimate.

- Для новых разработок оценка не должна быть ниже 3.0.

- Должно быть обеспечено покрытие тестами, минимум 90%.
 
- Должен быть настроен контроль соответствия кода style-guide, на базе Hound.
- Тестирование должно осуществляться с разными версиями зависимостей. Для этого нужно использовать appraisal.  
  В первую очередь это касается зависимости от Rails. Гем должен тестироваться как минимум на двух версиях: основной используемой в проектах отдела, на данный момент и следующей минорной.  
  Лучше тестировать на всех стабильных версиях, если это не сложно реализовать.  
  Данное требование может быть не реализовано в отдельных сложных случаях, по согласованию с тимлидом и ТД, в том случае когда это невозможно или требует больших трудозатрат.

- README.md должен содержать бейджи Dolly, Сode Сlimate и test coverage, другие по вкусу.
  Код должен быть оформлен согласно style-guide.

- Все изменения в репозитории гема осуществляются через PR.

- Утвердить PR, должно как минимум 2 тимлида и автор гема.  
  Реакция ревьюверов, в рабочий день, не должна превышать 3 часа.  
  Это касается гемов, которые используются на других проектах или потенциально могут использоваться.  
  Специфичные гемы для одного проекта, рецензируют разработчики данного проекта. Приглашать других людей по желанию.  
  
- Все гемы используемые в проектах должны быть выпущены либо на gems.rails.ru, либо на rubygems.org  
  Прямые ссылки в gem-файле допускаются, только на период разработки задачи.

- Разработка новой версии гема ведется в ветке master или feature. В процессе разработки новая, версия не выпускается, гем подключается с указанием источника-репозитория.  
  После того как задача протестирована, выпускается новая версия. Подключается гем конкретной версии.    
  Основное правило: не выпускать в паблик не проверенный код, не нарушать стабильность других проектов.

- Релиз гема может выпускать любой, у кого есть права на push.

- Гем должен иметь rake-задачи по автоматизированному выпуску релиза.  
  Пример: apress-amazon_assets
  
- Гем должен иметь changelog.  
  Пример: https://github.com/abak-press/apress-products/blob/master/CHANGELOG.md
  
- Все релизы гема должны быть помечены тегом.

- Версии зависимостей ограничиваем согласно http://guides.rubygems.org/patterns/#declaring-dependencies
  Используем “pessimistic” подход, ограничиваем мажорную версию.
 
- Новый репозиторий может создать любой имеющий админские права. Заявка подается тимлидом, администратору. Указывает название и публичность гема.

Для поддержки общей, для всех гемов, функциональности, используется гем apress-gems.

Контролируют выполнение требований, лица принимающие ПР.

В отдельных случаях, допускается не выполнение отдельных требований. Это возможно, по согласованию автора, принимающих ПР и ТД.

Существующие гемы, которые не удовлетворяют данным требованиям, должны быть, постепенно, доведены до соответствия требованиям. Задачу на реализацию выполнения, конкретного, не реализованного требования, может поставить тимлид, ПМ или ТД, в рамках задачи по доработке гема или как отдельную задачу.
