Компоненты
==========

Компоненты реализуются с помощью библиотеки [react](https://reactjs.org/).
Логически выделенная часть интерфейса приложения. Один компонент приложения представляет собой папку в `app/components` 
и может содержать один или несколько React-компонентов. Внутри `app/components` не используются подпапки. Компонент 
импортируется только через индексный файл, другие компоненты ничего не знают о его структуре.


### 1. Структура компонента

Папка `SomeComponent`.

Cтруктура папки:

* `/__tests__ ` - Тесты. Содержит файлы `ИмяТестируемогоФайла.spec.js`

* `/styles`     - Стили. Обычно один файл `имя-папки.scss`

* `/views`      - "Глупые" компоненты. Принимают пропсы и по ним что-то отрисовывают: другие React-компоненты или 
                  разметку не имеют состояния или lifecycle-методов описываются функцией, function declaration или 
                  стрелочной.

* `/containers` - Компоненты-контейнеры готовят данные для “глупых” компонентов содержат в себе логику работы 
                  приложения, обработчики событий имеют state и/или lifecycle-методы описываются классом

* `/connectors` - Компоненты-коннекторы оборачивают другой компонент(контейнер или view) в [connect][1] из 
                  react-redux для работы со store и actions. Для того, чтобы достать данные из store, могут быть 
                  использованы селекторы, созданные с помощью [reselect](https://github.com/reactjs/reselect).

* `/propTypes`  - Обычно один файл index.js с prop types для всех views и containers этой папки

* `index.js`    -  Дефолтный экспорт React-компонента, который является точкой входа в наш компонент

В папках `views`, `containers`, `connectors` также содержится `index.js` с экспортом всех файлов данной папки.

[1]: https://github.com/reactjs/react-redux/blob/master/docs/api.md#connectmapstatetoprops-mapdispatchtoprops-mergeprops-options


## 2. Оформление React-компонентов

Все компоненты используют jsx - синтаксис. Файл с React-компонентом имеет название в camel case и расширение js 
(не jsx). В конце названия добавляется его тип, например: `SomeComponentView.js`, `SomeComponentContainer.js`. В начале 
файла находятся импорты всех зависимостей, затем код компонента. Во views и containers после кода компонента находится 
присвоение propTypes и defaultProps. В конце файла - дефолтный экспорт.

Все импорты - абсолютные в папке с приложением: `import { smth } from 'app/path/to/smth'` 
(не `import { smth } from ‘../../../path/to/smth’`).

Методы компонента, которые передаются в дочерние компоненты, объявляются через class properties, чтобы сохранить this. 

В render стрелочные функции стараемся не использовать. Методы компонента, которые используются только внутри самого 
компонента, объявляются методами класса, чтобы не создавать новую функцию на каждый экземпляр класса.

Объекты, к которым есть обращение по нескольким ключам, деструктурируются.

Прммер деструктуризации:
```javascript
   const {
     props: {
       isFetching,
       userOrders,
       totalPages,
       activePage,
       location: { query },
     },
     handleSelect,
   } = this;
```

В компонентах не используется напрямую `dispatch`, все экшны должны быть обернуты в него через 
[connect][2].

Размер одного компонента стараемся держать в рамках одного-двух экранов.

Если понадобился location или другие параметры урла, оборачиваем корневой компонент в  [withRouter][3] из react-router.

[2]: https://github.com/reactjs/react-redux/blob/master/docs/api.md#connectmapstatetoprops-mapdispatchtoprops-mergeprops-options
[3]: https://github.com/ReactTraining/react-router/blob/master/packages/react-router/docs/api/withRouter.md


## 3. Стили компонентов

Для стилей используется [sass](https://sass-scss.ru/) с синтаксисом scss.

В один из файлов c компонентами (обычно первый после коннектора в цепочке) подключается файл со стилями 
`styles/some-component.scss`. Он содержит стили для всех React-компонентов в папке.

Корневой элемент в верстке обычно имеет класс some-component, остальные добавляют к этому классу some-component-link. 
Для конструирования классов по условиям используется библиотека [classnames](https://github.com/JedWatson/classnames).
