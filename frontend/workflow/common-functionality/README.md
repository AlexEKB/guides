Изменение общей функциональности
================================

Если какой-либо группе необходимо внести изменения в общеиспользуемую (используемую на разных проектах)
функциональность, то такие изменения предварительно должны быть согласованы и вынесено решение по поводу того, чьими
силами будут проводиться данные изменения - силами группы, которой нужны эти изменения, либо сервисной группой,
ответственной за эту функциональность.

В случае, если общая функциональность находится в репозитории, за который ответственна сервисная группа, то
согласовывать изменения необходимо с этой группой (на уровне менеджеров). Если общая функциональность находится в
репозитории, который явно не относится к какой-либо сервисной группе, то изменения необходимо согласовывать с
руководителем отдела фронтенд-разработки.

Перед принятием изменений в общую функциональность, необходимо обязательное код-ревью ответственных за эту
функциональность людей - либо фронтенд-разработчика сервисной группы, либо руководителя отдела.


## Список сервисных групп и репозиториев, за которые они отвечают

* Коммуникации [не активна. За гемы отвечает Большаков Иван]

  - `apress-company_reviews`
  - `apress-company_reviews-orders`
  - `apress-product_reviews`
  - `apress-videos`
  - `apress-notifications`
  - `apress-clearance`
  - `apress-clearance-front`
  - `mars-integration`
  - `mars`

* Товары [За гемы отвечает Быченкова Людмила]

  - `apress-eti`
  - `apress-eti-storefront`
  - `apress-eti-related_products`
  - `apress-eti-company_abouts`
  - `apress-eti-deals`
  - `apress-eti-company_traits`
  - `apress-tiger`
  - `apress-assets-table`
  - `apress-companies-currency_rates`
  - `apress-product_groups-front`
  - `apress-treeview-assets`
  - `apress-online_stores`
  - `apress-rubric_binding`

* Заказы [За гемы отвечает Большаков Иван]

  - `apress-orders`
  - `apress-demands-orders`
  - `apress-orders-callback`
  - `apress-orders-cart`
  - `apress-deals-orders`
  - `apress-company_reviews-orders`
  - `cosmos-treasury`
  - `cosmos-client`

* СК [не активна. За гемы отвечает Лёвушкина Марина]

  - `apress-companies`
  - `apress-companies-templates`
  - `apress-company_admin`
  - `apress-companies-pages`
  - `apress-companies-menus`
  - `apress-company_abouts`
  - `apress-text_editor`
  - `apress-companies-sliders`
  - `apress-companies-geo`
  - `apress-company-statistics`
  - `apress-trait_companies`
  - `apress-traits`
  - `apress-company_traits`


## Release notes

Любые изменения общей функциональности должны быть отражены в релиз ноутах репозитория, в который вносятся изменения.
В каждом репозитории с общей функциональностью есть автоматически генерируемый с помощью CI файл `CHANGELOG.md` - он
отражает список изменений каждой версии общей функциональности. Фактически, там просто перечисляются коммиты
(вместе с commit-message), добавленные в кодовую базу в каждой новой версии. Для версионирования используется
[semver](https://semver.org/). Для оформления commit-message используется
[abak-flow](../../../abak-flow#Требования-к-оформлению-коммитов).

Semver предполагает 3-уровневую схему версионирования - `MAJOR.MINOR.PATCH`:

* `MAJOR` - выпускается, когда сломана обратная совместимость;

* `MINOR` - выпускается, когда добавилась новая функциональность без потери обратной совместимости;

* `PATCH` - выпускается при фиксе какого-то бага без потери обратной совместимости.


При внесении изменений в общую функциональность очень важно понимать, как эти изменения отразятся на версии. Обновлением
версии гема на конкретном проекте могут заниматься другие люди, которые не погружены в контекст вносимых в общую
функциональность изменений.

Поэтому, при любом изменении кода в общеиспользуемых репозиториях, необходимо оформлять тело (`<body>`)
commit-message следующим образом:

```
[VERSION] changes
```

где:

* `VERSION` - идентификатор, позволяющий понять, на какую версию влияет данное изменение (`MAJOR`, `MINOR`, `PATCH`).

* `changes` - описание (на русском) вносимых изменений, возможно, ссылки на инструкции и прочая полезная информация,
              которая позволит проще обновить версию в конкретном месте подключения (на проекте).

Пример:

```
feature(orders): create new orders API module

[MAJOR] Добавит новый модуль для отправки заказов в API заказов. Все старые способы отправки заказов работать не будут.
Для создания заказа необходимо тригерить событие createOrder:ordersAPI.  Подробная инструкция - https://link-to-manual.com
https://jira.railsc.ru/browse/ORDERS-000
```

Данное сообщение автоматически добавится в `CHANGELOG.md` при выпуске новой версии и позволит проще обновить
общую функциональность в местах подключения.

Также, почти всегда, при выпуске новой версии общей функциональности добавляется не один коммит, а несколько. Явная
идентификация типа изменений (`MAJOR`, `MINOR`, `PATCH`) в каждом коммите, позволяет более правильно выпускать
итоговую версию.
